Investigating two super-resolution methods for
downscaling precipitation: ESRGAN and CAR
Campbell D. Watson
IBM Research, USA
cwatson@us.ibm.comChulin Wang
IBM Research, USA
Northwestern University
wangc@u.northwestern.edu
Timothy Lynar
University of New South Wales, Australia
t.lynar@adfa.edu.auKomminist Weldemariam
IBM Research-Africa, Nairobi, Kenya
k.weldemariam@ke.ibm.com
Abstract
In an effort to provide optimal inputs to downstream modeling systems (e.g., a
hydrodynamics model that simulates the water circulation of a lake), we hereby
strive to enhance resolution of precipitation ﬁelds from a weather model by up to
9x. We test two super-resolution models: the enhanced super-resolution genera-
tive adversarial networks (ESRGAN) proposed in 2017, and the content adaptive
resampler (CAR) proposed in 2020. Both models outperform simple bicubic inter-
polation, with the ESRGAN exceeding expectations for accuracy. We make several
proposals for extending the work to ensure it can be useful tool for quantifying
the impact of climate change on local ecosystems while removing reliance on
energy-intensive, high-resolution weather model simulations.
1 Introduction
Weather prediction at a high spatial resolution is valuable and often essential for many applications
including ﬂood prediction and water management, renewable energy production, and wildﬁre fore-
casting. However, its production using traditional approaches (e.g., numerical weather prediction
models) is computationally expensive. Recently, researchers have been exploring the use of machine
learning techniques to downscale coarser resolution weather and climate simulations to ﬁner resolu-
tion grids. Broadly speaking, four machine learning methods for have been described in the literature:
Regression based methods, analog methods, auto-regression methods, and deep neural network super
resolution based methods (e.g., Larraondo et al. [2017], Mouatadid et al. [2017], Coulibaly et al.
[2005], He et al. [2016], Rodrigues et al. [2018], Bano-Medina et al. [2018], Rebora et al. [2006].
The latter method encompasses convolutional and generative adversarial neural networks for super
resolution.
The motivation for this work stems from The Jefferson Project at Lake George, a multiyear research
initiative based at Lake George, New York, USA that has a goal of understanding the impact of
human activity on fresh water, and how to mitigate those effects. A recent discovery (see Auger et al.
[Submitted]) is that hydrodynamic simulations of Lake George are considerably more accurate when
forced with high-resolution weather model data (<1 km horizontal resolution). A particularly striking
result is that after one month of simulation, the hypolimnetic volume of the lake reduces by 15%
when forced with weather information generated at 0.33 km resolution – in line with observations –
compared to 3 km. In other words, the livable zone for cold-water ﬁsh reduces by 15%, which has
signiﬁcant implications for understanding the impact of a warming climate on lake biological activity.
34th Conference on Neural Information Processing Systems (NeurIPS 2020), Vancouver, Canada.Given the apparent importance of high-resolution weather data to accurately model the long-term
changes of mid- and small-sized lakes, and given the exorbitant computational expense (and carbon
footprint) of generating such high-resolution simulations with a physics-based weather model, we
hereby examine the feasibility of using two super-resolution models to generate high-resolution
inputs from coarse resolution weather model data. We strive for a resolution increase of up to 9x,
more than most recent ML-based downscaling studies (e.g., Manepalli et al. [2020]). Successful
implementation will have far-reaching consequences for improving our understanding of local weather
impacts at climatic scales on vulnerable ecosystems and reduce the energy consumption of running
high-resolution weather models.
This manuscript presents early results for precipitation only, although other weather variables (wind,
downward radiation, humidity) are equally important for coupling with hydrodynamic simulations. It
builds on previous attempts at downscaling using tree-based regression models trained at every grid
cell (Watson and Lynar [2020]), which were found to be inferior to super-resolution algorithms.
2 Data and Methods
All precipitation data used in this study was generated by version 3.8.1 of the Advanced Research
version of the Weather Research and Forecasting (WRF) Model (Skamarock and Coauthors [2008]).
Daily, operational weather forecasts for Lake George have been performed for Lake George with
four (one-way coupled) domains with horizontal resolutions of 9 km, 3 km, 1 km and 0.33 km (Fig.
1). Each domain has 42 vertical levels (with 14 below 1 km), a 50-hPa model top, and a 5 km-deep
upper-level absorbing layer. Further details can be found in Auger et al. [Submitted].
Figure 1: WRF model domains in northeast USA
(Lake George is outlined in red). This manuscript
uses WRF data from the three outer domains with
9, 3 and 1 km grid resolution.We use hourly WRF data from 2017-01-01 to
2020-03-20 (with an 80%/20% split at 2019-08-
01) in an effort to reconstruct the simulated 1
km WRF data with 3 km and 9 km WRF data.
In other words:
•Experiment 1: Feature values are 3 km
WRF variables; target variable is 1 km
WRF precipitation
•Experiment 2: Feature values are 9 km
WRF variables; target variable is 1 km
WRF precipitation
The WRF variables used in this study are hourly
accumulated surface precipitation, and instanta-
neous 2 m temperature, u- and v- 10 m winds,
2 m speciﬁc humidity and surface pressure. All
variables are output at hourly intervals.
2.1 Downscaling with ESRGAN
The enhanced super-resolution generative ad-
versarial networks (ESRGAN) is a deep neu-
ral network approach which was initially cre-
ated for use with natural images which typi-
cally have no inherent resolution. Image super-
resolution models have received increased appli-
cation in the physical sciences, with Manepalli
et al. [2020] ﬁnding the ESRGAN has encour-
aging transferable and generalizable properties
(and can even reproduce the simulated power
spectral density of near-surface winds).
We employed the SRResNet structure with the Residual-in-Residual Dense Block (RRDB) as basic
blocks, as proposed by Wang et al. [2019] paper. We used the default training parameters mentioned
in ESRGAN, except with 3x- instead of 2x-upsampling blocks. In order to optimize for the prediction
2accuracy rather than visual quality, the training is PSNR-oriented without adding VGG or GAN loss
(as per the recommendation in Wang et al. [2019]).
2.2 Downscaling with Content Adaptive Resampler
Recently, Sun and Chen [2020] proposed a new content adaptive-resampler (CAR) based image
downscaling method. Brieﬂy, the resampler network generates content adaptive image resampling
kernels which are applied to the original high-resolution input to generate pixels on the downscaled
image. This resampler is different to traditional bilinear downscaling as it is dynamic and uses
meta-learning that in turn utilises ﬁlters similar to dynamic ﬁlter networks. We employed the CAR
model implemented with Pytorch using the default conﬁgurations as proposed by Sun and Chen
[2020].
3 Preliminary Results
The ESRGAN systematically outperformed the CAR model, presenting accurate reconstructions well
beyond expectations. The long timeseries of WRF data ensures ample training and testing examples,
with the 80/20% train/test split providing almost 8 months of continuous data for testing the skill of
the models. Overall, the mean absolute error (MAE) is shown in Table 1 along with that obtained via
standard bicubic interpolation (a simple baseline model).
Table 1: Mean absolute error using different methods. The output grid resolution is 1 km, and the
input grid resolution is listed in the table. The ESRGAN model has the best performance, followed
by the CAR model. Both of the proposed models outperform the baseline bicubic interpolation.
Input grid resolutionMean absolute error (mm/hr)
Bicubic ESRGAN CAR
3 km 0.83 0.040 0.384
9 km 1.98 0.078 0.931
Speciﬁc events were extremely well captured by the ESRGAN (e.g., Fig. 2), and although it did
systematically underestimate precipitation by up to 0.1 mm/hr (not shown), it motivates us to continue
investigation with this model. In contrast, the CAR method retained many visual features of the
coarser resolution precipitation input; perhaps additional testing with different conﬁgurations can
improve results.
4 Discussion and Broader Impacts
This study has demonstrated the utility of two super-resolution methods to downscale precipitation
in the northeast US. The ESRGAN outperformed the CAR method, especially when downscaling
from 9 km to 1 km precipitation. The signiﬁcant 9x super-resolution is particularly encouraging
because the WRF model uses different physics to simulate precipitation at 9 km resolution vs 1 km
(we used the Grell-Freitas cumulus scheme in the 9 km domain, whereas cumulus-scale precipitation
is assumed to be explicitly simulated in the 1 km domain).
We are excited for the potential impact of this work. Accurate downscaling methods could reduce
time spent running expensive computational code and thus reducing the carbon footprint of weather
forecasting modeling.
Further investigation has been identiﬁed:
•Expand analysis to include additional variables, speciﬁcally near surface winds, surface hu-
midity and downward short and long wave radiation. These are key inputs to hydrodynamic
models.
•Apply ESRGAN to downscale GFS data (which provides boundary conditions to the WRF
model) at 25 km resolution to the 1 km WRF domain. This is a particularly demanding task
given the GFS model has different model parameterizations and dynamical core.
3Figure 2: Example of precipitation reconstructions by the ESRGAN and CAR models from 9 km to 1
km horizontal resolution. The panels show accumulated precipitation (mm/hr) in the hour preceding
2019-11-01 04:00 UTC. (a) Original WRF precipitation from the 9 km domain; (b) original WRF
precipitation from the 1 km domain (target); reconstruction by ESRGAN to 1 km resolution; and (d)
reconstruction by the CAR model to 1 km resolution
•How transferable and generalizable is this approach? Manepalli et al. [2020] showed some
success in this regard using ESRGAN to downscale winds, and is key to moving to climatic
geographies.
•How much data is required to adequately train the model? Here, we provided over nearly 2.5
years of hourly data for training; a prohibitive amount of simulation for larger geographic
areas. Can we leverage any correlations across time to improve the super-resolution (e.g.,
low resolution sequence in, high resolution sequence out)?
Finally, we do not believe the data is biased nor do we expect people to be put at disadvantage from
this research. That said, a failure of the super-resolution system could result in inaccurate weather and
climate predictions, which could have negative consequences for policy development and decision
making.
Acknowledgments and Disclosure of Funding
We gratefully acknowledge assistance by personnel associated with the Jefferson Project at Lake
George, a collaboration between Rensselaer Polytechnic Institute, IBM Research and the FUND for
4Lake George. In addition to funding from the three partners, the sensor network has been partially
supported by a NSF MRI grant (#1655168) and a New York State Higher Education Capital grant
(#7290).
References
G. Auger, C. Watson, and H. Kolar. The inﬂuence of weather forecast resolution on the circulation of Lake
George, NY. Water Resources Research , Submitted.
J. Bano-Medina, J. M. Gutierrez, and S. Herrera. Deep neural networks for statistical downscaling of climate
change projections CAEPIA 2018. XVIII Conferencia de la Asociaci on Espanola para la Inteligencia
Artiﬁcial , pages 1419–1424, 2018.
P. Coulibaly, Y . B. Dibike, and F. Anctil. Downscaling precipitation and temperature with temporal neural
networks. Journal of Hydrometeorology , 6(4):483–496, 2005. doi: 10.1175/JHM409.1. URL https:
//doi.org/10.1175/JHM409.1 .
X. He, N. W. Chaney, M. Schleiss, and J. Shefﬁeld. Spatial downscaling of precipitation using adaptable random
forests. Water Resources Research , 52(10):8217–8237, 2016. doi: 10.1002/2016WR019034.
P. R. Larraondo, I. Inza, and J. A. Lozano. Automating weather forecasts based on convolutional networks. In
Workshop on Deep Structured Prediction ICML17 Sydney 10 August 2017 , 2017. They use a cnn to come up
with a forecast not to downscale.
A. Manepalli, A. Singh, M. Mudigonda, B. White, and A. Albert. Generalization properties of machine learning
based weather model downscaling. International Conference on Learning Representations , pages 1–8, 2020.
S. Mouatadid, S. Easterbrook, and A. R. Erler. A machine learning approach to non-uniform spatial downscaling
of climate variables. In 2017 IEEE International Conference on Data Mining Workshops , 2017.
N. Rebora, L. Ferraris, J. von Hardenberg, and A. Provenzale. Rainfarm: Rainfall downscaling by a ﬁltered
autoregressive model. Journal of Hydrometeorology , 7(4):724–738, 2006. doi: 10.1175/JHM517.1. URL
https://doi.org/10.1175/JHM517.1 .
E. R. Rodrigues, I. Oliveira, R. L. F. Cunha, and M. A. S. Netto. Deepdownscale: a deep learning strategy for high-
resolution weather forecast. CoRR , abs/1808.05264, 2018. URL http://arxiv.org/abs/1808.05264 .
W. C. Skamarock and Coauthors. A description of the advanced research wrf version 3. NCAR Tech. Note
NCAR/TN-4751STR , 2008.
W. Sun and Z. Chen. Learned image downscaling for upscaling using content adaptive resampler. IEEE
Transactions on Image Processing , 29:4027–4040, 2020.
X. Wang, K. Yu, S. Wu, J. Gu, Y . Liu, C. Dong, Y . Qiao, and C. C. Low. Esrgan: Enhanced super-resolution
generative adversarial networks. In L. Leal-Taixe and S. Roth, editors, Computer Vision – ECCV 2018
Workshops. Lecture Notes in Computer Science, vol 11133 , pages 1–16. Springer, Cham., 2019.
C. D. Watson and T. Lynar. Lessons from downscaling precipitation in Tasmania, Australia and the Northeast
United States using machine learning approaches. 19th Conference on Artiﬁcial Intelligence for Environmental
Science at the American Meteorological Society 100th Annual Meeting, 2020.
5